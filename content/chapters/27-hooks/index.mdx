---
slug: "27-hooks"
title: "Hooks: 규칙의 강제, 자동화의 시작"
description: "Claude Code의 Hook 시스템을 활용하여 도구 실행 전후에 자동화된 가드레일을 설정하는 방법을 배웁니다."
part: 6
partTitle: "고급 기능 - MCP, Hooks, Agents"
chapter: 27
order: 27
readingTime: "6분"
difficulty: "intermediate"
tags: ["Hooks", "자동화", "가드레일"]
draft: false
---

## 개요

Hooks는 Claude Code가 도구를 사용하기 전후, 권한 요청 시, 알림 발생 시, 서브에이전트 시작/종료 시에 자동으로 실행되는 스크립트입니다. CLAUDE.md의 지시는 무시될 수 있지만, Hooks는 프로그래밍적으로 강제되므로 반드시 실행됩니다.

## Hook 이벤트 종류

| 이벤트 | 실행 시점 | 용도 |
|--------|-----------|------|
| `PreToolUse` | 도구 실행 전 | 위험한 명령 차단 |
| `PostToolUse` | 도구 실행 후 | 결과 검증, 로깅 |
| `PermissionRequest` | 권한 요청 시 | 자동 승인/거부 규칙 |
| `Notification` | 알림 발생 시 | 외부 알림 전송 |
| `SubagentStart` | 서브에이전트 시작 시 | 서브에이전트 제어 |
| `SubagentStop` | 서브에이전트 종료 시 | 결과 수집 |

## 위험한 명령어 차단 예시

`.claude/settings.json`에서 Hooks를 설정합니다:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "script": "node .claude/hooks/block-dangerous.js"
      }
    ]
  }
}
```

차단 스크립트 예시:

```javascript
// .claude/hooks/block-dangerous.js
const input = JSON.parse(process.argv[1] || '{}');
const command = input.tool_input?.command || '';

const DANGEROUS_PATTERNS = [
  /rm\s+-rf\s+\//,
  /sudo\s+/,
  /chmod\s+777/,
  /curl.*\|\s*sh/,
  /git\s+push\s+--force\s+origin\s+main/,
];

for (const pattern of DANGEROUS_PATTERNS) {
  if (pattern.test(command)) {
    console.error(JSON.stringify({
      decision: "block",
      reason: `Blocked dangerous command: ${command}`
    }));
    process.exit(0);
  }
}

console.log(JSON.stringify({ decision: "allow" }));
```

## tmux 경고 Hook 예시

Claude가 tmux 명령을 실행하려 할 때 경고를 표시하는 Hook입니다:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "script": "node .claude/hooks/tmux-warning.js"
      }
    ]
  }
}
```

```javascript
// .claude/hooks/tmux-warning.js
const input = JSON.parse(process.argv[1] || '{}');
const command = input.tool_input?.command || '';

if (/tmux/.test(command)) {
  console.error(JSON.stringify({
    decision: "block",
    reason: "tmux commands are blocked. Use separate terminal tabs instead."
  }));
  process.exit(0);
}

console.log(JSON.stringify({ decision: "allow" }));
```

<Callout type="tip" title="CLAUDE.md vs Hooks">
CLAUDE.md에 "rm -rf를 사용하지 마세요"라고 작성하면 Claude가 이를 **무시할 수도 있습니다**. 하지만 Hook으로 차단하면 **프로그래밍적으로 강제**되어 절대로 실행되지 않습니다.
</Callout>

<Callout type="info" title="PostToolUse 활용">
PostToolUse Hook을 사용하면 파일이 변경될 때마다 자동으로 린트를 실행하거나, 테스트를 수행하거나, 변경 로그를 기록하는 자동화를 구축할 수 있습니다.
</Callout>

<Practice>
  <PracticeItem>.claude/hooks/ 디렉토리에 위험한 명령어를 차단하는 PreToolUse Hook 스크립트를 작성하고 설정해보세요</PracticeItem>
  <PracticeItem>PostToolUse Hook을 만들어 파일 변경 시 자동으로 ESLint를 실행하도록 설정해보세요</PracticeItem>
</Practice>
