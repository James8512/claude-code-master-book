---
slug: "43-write-test-cycle"
title: "완전한 작성-테스트 사이클"
description: "코드 작성부터 테스트 실행, 수정, 반복까지 Claude Code로 완전한 개발 사이클을 자동화하는 방법을 배웁니다."
part: 10
partTitle: "실전 활용 사례"
chapter: 43
order: 43
readingTime: "7분"
difficulty: "intermediate"
tags: ["테스트", "사이클", "TDD"]
draft: false
---

## 코드-테스트 사이클이란?

좋은 소프트웨어는 코드와 테스트가 함께 성장합니다. Claude Code를 사용하면 코드 작성, 테스트 작성, 실행, 실패 분석, 수정을 하나의 연속된 사이클로 처리할 수 있습니다.

## 실전 사례: 인증 미들웨어

### 1단계: 코드 작성

```
> Express.js 인증 미들웨어를 작성해줘.
  JWT 토큰 검증, 만료된 토큰 처리, 역할 기반 접근 제어를 포함해줘
```

Claude Code가 `src/middleware/auth.ts` 파일을 생성합니다.

### 2단계: 테스트 작성

```
> 방금 작성한 인증 미들웨어에 대한 단위 테스트를 작성해줘.
  정상 토큰, 만료된 토큰, 잘못된 토큰, 권한 부족 케이스를 모두 포함해줘
```

Claude Code가 `tests/middleware/auth.test.ts` 파일을 생성합니다.

### 3단계: 실행 및 수정

```
> 테스트를 실행해줘
```

```bash
$ npx jest tests/middleware/auth.test.ts

 FAIL  tests/middleware/auth.test.ts
  ✓ 유효한 토큰으로 인증 성공 (5ms)
  ✗ 만료된 토큰 거부 (3ms)
  ✓ 잘못된 형식의 토큰 거부 (2ms)
  ✗ admin 역할 필요 시 일반 사용자 거부 (2ms)
```

```
> 실패한 테스트를 분석하고 코드를 수정해줘
```

<Callout type="info" title="자동 반복의 힘">
Claude Code는 테스트를 실행하고 실패 원인을 분석한 뒤, 코드를 수정하고, 다시 테스트를 실행하는 과정을 자동으로 반복합니다. 개발자는 최종 결과만 확인하면 됩니다.
</Callout>

### 4단계: 모든 테스트 통과

```
> 테스트를 다시 실행해줘

$ npx jest tests/middleware/auth.test.ts

 PASS  tests/middleware/auth.test.ts
  ✓ 유효한 토큰으로 인증 성공 (5ms)
  ✓ 만료된 토큰 거부 (3ms)
  ✓ 잘못된 형식의 토큰 거부 (2ms)
  ✓ admin 역할 필요 시 일반 사용자 거부 (3ms)
```

## TDD 워크플로우

테스트 주도 개발(TDD)에서는 순서가 반대입니다. 먼저 실패하는 테스트를 작성한 뒤, 테스트를 통과하는 최소한의 코드를 작성합니다.

<Steps>
<Step title="실패하는 테스트 작성">
```
> 사용자 등록 함수에 대한 테스트를 먼저 작성해줘.
  아직 구현은 하지 마. 테스트만 작성해줘.
  - 유효한 입력으로 사용자 생성 성공
  - 중복 이메일로 등록 시 에러
  - 약한 비밀번호로 등록 시 에러
```
모든 테스트가 실패하는 것을 확인합니다.
</Step>
<Step title="커밋: 실패하는 테스트">
```
> 실패하는 테스트를 커밋해줘. 메시지: "test: add user registration tests (red)"
```
TDD에서는 실패하는 테스트도 커밋합니다.
</Step>
<Step title="최소한의 구현">
```
> 이제 테스트를 통과하는 최소한의 코드를 작성해줘. 과도한 추상화 없이.
```
테스트를 통과하기 위한 가장 단순한 구현을 작성합니다.
</Step>
<Step title="테스트 통과 확인">
```
> 테스트를 실행해서 모두 통과하는지 확인해줘
```
</Step>
<Step title="커밋: 통과하는 코드">
```
> 통과하는 코드를 커밋해줘. 메시지: "feat: implement user registration (green)"
```
</Step>
</Steps>

<Callout type="tip" title="Red-Green-Commit 리듬">
TDD의 핵심은 리듬입니다: 빨간색(실패) → 커밋 → 초록색(통과) → 커밋. Claude Code와 함께하면 이 리듬을 빠르고 자연스럽게 유지할 수 있습니다.
</Callout>

<Practice>
  <PracticeItem>기존 프로젝트에서 테스트가 없는 함수를 하나 골라, Claude Code에게 테스트 작성 → 실행 → 실패 분석 → 코드 수정 사이클을 실행해보세요</PracticeItem>
  <PracticeItem>새로운 기능을 TDD 방식으로 구현해보세요: 실패하는 테스트를 먼저 작성하고, 최소한의 구현으로 통과시킨 뒤, 커밋하세요</PracticeItem>
</Practice>
